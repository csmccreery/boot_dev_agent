from pathlib import Path
from os.path import getsize

def get_common_path(paths):
    zipped_parts = zip(*(p.parts for p in paths))
    
    common_parts = []
    for part_tuple in zipped_parts:
        if len(set(part_tuple)) == 1:
            common_parts.append(part_tuple[0])
        else:
            break

    return Path(*common_parts)

def validate_path(working_dir, dir):
    absolute_working_dir = Path(working_dir).absolute()
    target_dir = (absolute_working_dir / dir).resolve()
    common_path = get_common_path([absolute_working_dir, target_dir])

    if not Path(target_dir).is_dir():
        return false, f"Error: '{directory}' is not a directory"

    if not common_path == absolute_working_dir:
        return false, f"Error: Cannot list '{directory}' as it is outside the permitted working directory"

    return true, ""
